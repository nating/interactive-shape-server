<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Interactive Shape Server</title>

    <!-- Bootstrap core CSS -->
    <link href="https://rawgit.com/BlackrockDigital/startbootstrap-business-casual/master/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">

    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template -->
    <link href="https://rawgit.com/BlackrockDigital/startbootstrap-business-casual/master/css/business-casual.css" rel="stylesheet" type="text/css">

  </head>

  <body style="background-color: black;">

    <div style="background-color: black;height:100%;">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-faded py-lg-4">
      <div class="container">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item active px-lg-4">
              <a class="nav-link text-uppercase text-expanded" href="/">Home
                <span class="sr-only">(current)</span>
              </a>
            </li>
            <li class="nav-item px-lg-4">
              <a class="nav-link text-uppercase text-expanded" href="https://github.com/nating/functional/assignment-1">See Source</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">

      <div class="bg-faded p-4 my-4">
        <!-- Image Carousel -->
        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
          <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
              <img class="d-block img-fluid w-100" src="img/slide-1.jpg" alt="">
            </div>
        </div>
        <!-- Welcome Message -->
        <div class="text-center mt-4">
          <div class="text-heading text-muted text-lg">Welcome To</div>
          <h1 class="my-2">The Interactive Shape Server</h1>
          <div class="text-heading text-muted text-lg">
            <strong>By Geoffrey Natin</strong>
          </div>
        </div>
        <div id="svgBox" style="display:block;margin:auto;text-align:center;justify-content: center; flex-direction: row;align-content: center;align-items: center;"><!--?xml version="1.0" encoding="UTF-8"?-->
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="500" height="500" viewBox="0 0 50 50">
          <rect width="1" height="1" transform="skewX(0.0)scale(50.0 50.0)translate(0.0 0.0)" fill="Black" stroke="Aqua" stroke-width="0.1" fill-opacity="0.8"></rect>
          <circle r="1" transform="skewX(0.0)scale(25.0 25.0)translate(1.0 1.0)" fill="Black" fill-opacity="0.8"></circle>
          <rect width="1" height="1" transform="skewX(30.0)scale(5.0 20.0)translate(2.25 0.75)" fill="Green"></rect>
          <rect width="1" height="1" transform="skewX(30.0)scale(5.0 10.0)translate(1.0 1.5)" fill="Blue"></rect>
          <rect width="1" height="1" transform="skewX(-30.0)scale(5.0 10.0)translate(6.75 2.5)" fill="Blue"></rect>
          <rect width="1" height="1" transform="skewX(-30.0)scale(5.0 10.0)translate(8.0 2.5)" fill="Green"></rect>
          <rect width="1" height="1" transform="skewY(0.0)scale(8.0 4.0)translate(4.25 5.3)" fill="Red"></rect>
          <rect width="1" height="1" transform="skewY(0.0)scale(6.0 4.0)translate(6.0 6.6)" fill="Red"></rect>
          <rect width="1" height="1" transform="skewX(30.0)scale(4.0 4.0)translate(4.5 6.6)" fill="Red"></rect>
          <rect width="1" height="1" transform="skewX(30.0)scale(4.0 4.0)translate(4.5 5.3)" fill="Red"></rect>
        </svg>
      </div>
      </div>

    </div>


      <div class="bg-faded p-4 my-4 text-center">
        <hr class="divider">
        <h2 class="text-center text-lg text-uppercase my-0">Watch your shapes come to life.
        </h2>
        <hr class="divider">
        <div class="form-group">
          <textarea class="form-control" rows="12" id="shapes-input">
            [
            (Square,Compose (Compose (Translate 0 0) (Scale 50 50)) (SkewX 0),StyleCompose (StyleCompose (StyleCompose (Fill Black) (StrokeColor Aqua)) (StrokeWidth 0.1)) (FillOpacity 0.8)),
            (Circle,Compose (Compose (Translate 1 1) (Scale 25 25)) (SkewX 0),StyleCompose (Fill Black) (FillOpacity 0.8)),
            (Square,Compose (Compose (Translate 2.25 0.75) (Scale 5 20)) (SkewX 30),Fill Green),
            (Square,Compose (Compose (Translate 1 1.5) (Scale 5 10)) (SkewX 30),Fill Blue),
            (Square,Compose (Compose (Translate 6.75 2.5) (Scale 5 10)) (SkewX -30),Fill Blue),
            (Square,Compose (Compose (Translate 8 2.5) (Scale 5 10)) (SkewX -30),Fill Green),
            (Square,Compose (Compose (Translate 4.25 5.3) (Scale 8 4)) (SkewY 0),Fill Red),
            (Square,Compose (Compose (Translate 6 6.6) (Scale 6 4)) (SkewY 0),Fill Red),
            (Square,Compose (Compose (Translate 4.5 6.6) (Scale 4 4)) (SkewX 30),Fill Red),
            (Square,Compose (Compose (Translate 4.5 5.3) (Scale 4 4)) (SkewX 30),Fill Red)
            ]
          </textarea>
        </div>
          <button onclick="renderSvg()" id="button" class="text-center btn btn-primary">Render my Shapes</button>
      </div>

    <!-- /.container -->

    <footer class="bg-faded text-center py-5">
      <div class="container">
        <p class="m-0">Copyright &copy; Geoffrey Natin 2017</p>
      </div>
    </footer>

    </div>

  </body>
  <script>

    document.getElementById("button").addEventListener("click",function(){renderSvg();});

    function renderSvg() {
      var input = document.getElementById("shapes-input").value; 
      fetch("/"+btoa(input), {  
          method: 'POST'
      })
      .then(function (data) {  
        console.log('Request success: ', data);
        var svgResponse = data.text().then(function (t){
          console.log(t);
          var svgBox = document.getElementById('svgBox');
          svgBox.innerHTML = t;
        });  
      })  
      .catch(function (error) {  
        //TODO: Add some code here to alert that there was an error
        console.log('Request failure: ', error);  
      });
    }
  </script>

</html>
